<!DOCTYPE html>
<html lang="pt-br" dir="ltr">
<head>
  <!-- Define o charset da página -->
  <meta charset="UTF-8">
  
  <!-- Define a viewport para responsividade em dispositivos móveis -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Importa a biblioteca SweetAlert2 para exibir alertas bonitos -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <!-- Importa o jQuery 3.6 para facilitar manipulação de DOM e requisições AJAX -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
  <!-- Pré-conexão com Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Importa a fonte Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Título da página -->
  <title>Cadastro AutoPrime</title>

  <!-- Importa o CSS principal da página -->
  <link rel="stylesheet" href="assets/css/style.css">
  

  <style>
    /* Container para o campo de senha e ícone */
    .password-container {
      position: relative;
      width: 100%;
    }
    
    /* Ícone para mostrar/ocultar a senha */
    .toggle-password {
      position: absolute;
      top: 20px;
      right: 32px;
      transform: translateY(-50%);
      cursor: pointer;
      width: 22px;
      height: 22px;
      fill: #555;
    }
  </style>
</head>

<body class="body-cadastro">
  <!-- Div principal do cadastro -->
  <div class="div-mae-cadastro">
    <div>
      <!-- Logo da empresa -->
      <img class="logo-cadastro" src="assets/img/Ariel.png" alt="Logo AutoPrime">

      <!-- Frases de destaque da página -->
      <h2 class="frase-cadastro">Qualidade, design e robustez</h2>
      <h2 class="frase2-cadastro">que transformam seu carro em<br>uma máquina única.</h2>
    </div>

    <div>
      <!-- Card central do cadastro -->
      <div class="card-cadastro center">
        <h1 class="tit-cadastro">Cadastre-se</h1>

        <!-- Formulário de cadastro -->
        <form id="formcadastro">
          <!-- Campo nome -->
          <input id="nome" class="input-cadastro" type="text" name="nome" placeholder="Nome" required>
          
          <!-- Campo email -->
          <input id="email" class="input-cadastro" type="email" name="email" placeholder="Email" required>

          <!-- Seleção de cargo -->
          <select id="cargo" class="input-cadastro" style="width: 329px;" name="cargo" required>
            <option value="" disabled selected>Cargo</option>
            <option value="cliente">Cliente</option>
            <option value="vendedor">Vendedor</option>
          </select>

          <!-- Container da senha com toggle -->
          <div class="password-container">
            <!-- Campo senha -->
            <input class="input-cadastro" type="password" id="senha" name="senha" placeholder="Senha" required>
            
            <!-- Ícone olho para mostrar/ocultar senha -->
            <svg class="toggle-password" onclick="togglePassword()" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm0-8a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/>
            </svg>
          </div>

          <!-- Aviso de política de privacidade -->
          <p class="p-cadastro">Ao continuar você concorda com nossos<br>
            <a href="politicaprivada.html" style="color: #008CFF;">Termos de Política e Privacidade</a>
          </p>

          <!-- Botão de cadastro -->
          <button id="btn-cadastro" class="btn-cadastro" type="submit">Cadastre-se</button>
        </form>
      </div>

      <!-- Link para login caso já possua conta -->
      <p class="sub-p">Já tem uma conta? 
        <a style="font-weight: 700; color: white;" href="login.html">Faça Login</a>
      </p>
    </div>
  </div>

  <script>
    /* Função para mostrar/ocultar a senha */
    function togglePassword() {
      const senhaInput = document.getElementById("senha"); // seleciona input da senha
      const icon = document.querySelector(".toggle-password"); // seleciona o SVG do olho

      if (senhaInput.type === "password") {
        // Se estiver oculto, mostra a senha
        senhaInput.type = "text";
        icon.innerHTML = '<path d="M2.39 1.73L1.11 3l3.1 3.1C2.96 7.09 1.72 9.34 1 12c1.73 3.89 6 7 11 7 2.23 0 4.3-.62 6.05-1.68L20.95 20l1.41-1.41-20-20z"/>';
      } else {
        // Se estiver visível, oculta a senha
        senhaInput.type = "password";
        icon.innerHTML = '<path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>';
      }
    }
  </script>

  <script>
    /* Evento de submit do formulário de cadastro */
    $("#formcadastro").on("submit", function (e) {
      e.preventDefault(); // previne envio padrão do formulário

      let dados = new FormData(this); // pega todos os dados do formulário

      /* Requisição AJAX para a API de cadastro */
      $.ajax({
        url: "http://10.92.3.135:5000/cadastro", // endpoint da API
        method: "POST",
        headers: {
          "Content-Type": "application/json" // define que o conteúdo é JSON
        },
        data: JSON.stringify({ // converte os dados do formulário em JSON
          nome: dados.get("nome"),
          email: dados.get("email"),
          cargo: dados.get("cargo"),
          senha: dados.get("senha")
        }),
        success: function (retorno) {
          // Se cadastro for bem-sucedido
          Swal.fire({
            title: "CADASTRO REALIZADO!",
            icon: "success"
          }).then(() => {
            window.location.href = "login.html"; // redireciona para a página de login
          });
        },
        error: function (retorno) {
          // Se houver erro no cadastro
          Swal.fire({
            icon: "error",
            title: "ERRO",
            text: retorno.responseJSON?.error || "Ocorreu um erro, tente novamente mais tarde."
          });
        }
      });
    });
  </script> 
</body>
</html>
